@model STrackerServer.Models.Home.HomeView

@{
    ViewBag.Title = "Home";
    Layout = "~/Views/Shared/MainLayout.cshtml";
}

<div class="container-fluid">
    <div class="row-fluid">
        <div class="span9">
            @if(Model.TopRated.Count != 0)
            {
                for (var i = 0; i < Math.Ceiling(Model.TopRated.Count / (double)4); i++)
                {
                    <div class="row-fluid">
                        @for (var index = 4 * i; (index < (4 * (i + 1))) && index < Model.TopRated.Count; index++)
                        {
                            <div class="span3" style="text-align: center">
                                <div class="box-whiter">
                                    <div class="row-fluid">
                                        <a href="@Url.Action("Index", "TvShows", new { id = @Model.TopRated.ElementAt(index).Id })">
                                            <img src="@Model.TopRated.ElementAt(index).Poster" alt="No Image"/>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        }     
                    </div>   
                }
            }   
        </div>
        <div class="span3">
            <div class="box">
                <div class="accordion" id="accordion">
                    <div class="accordion-group">
                        <div class="accordion-heading">
                            <h4>
                                <a class="accordion-toggle center" data-toggle="collapse" data-parent="#accordion" href="#Genres">
                                    Genres
                                </a> 
                            </h4>
                        </div>
                        <div id="Genres" class="accordion-body collapse">
                            <div class="accordion-inner">    
                                @foreach(var genre in Model.Genres)
                                {                          
                                    <dl>
                                        <dd>
                                            <a href="@Url.Action("Index","Genres", new { id = genre.Id })">
                                                @genre.Name.ToUpper()
                                            </a>
                                        </dd>
                                    </dl>
                                }
                            </div>
                        </div>     
                    </div>        
                </div>
            </div>
            
            @if(Model.NewEpisodes.Count != 0)
            {
                <div class="box blue-border">
                    <h2 style="text-align: center">Next Episodes</h2>
                </div>
 
                <div class="box blue-border">                        
                    @foreach(var entry in Model.NewEpisodes)
                    {
                        <dl>
                            <dt><a href="@Url.Action("Index", "TvShows", new { id = entry.TvShow.Id })">@entry.TvShow.Name</a></dt>
                            @foreach (var episode in entry.Episodes)
                            {
                                <dd>
                                    
                                    <span>S</span>@episode.Id.SeasonNumber
                                    <span>E</span>@episode.Id.EpisodeNumber
                                    <span> - <a href="@Url.Action("Index","Episodes", new { tvshowId = episode.Id.TvShowId, seasonNumber = episode.Id.SeasonNumber, episodeNumber = episode.Id.EpisodeNumber })">@episode.Name</a> - @episode.Date</span>
                                </dd> 
                            }
                        </dl>       
                    }
                </div>
            }
        </div>
    </div>
</div>



